#include "sha256.h"

int sha256_test()
{
	BYTE text1[] = {"abc"};
	BYTE text2[] = {"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"};
	BYTE text3[] = {"yang mei tang is really pretty and ivan is really excellent"};
	BYTE hash1[32] = {0xba,0x78,0x16,0xbf,0x8f,0x01,0xcf,0xea,0x41,0x41,0x40,0xde,0x5d,0xae,0x22,0x23,
	                                0xb0,0x03,0x61,0xa3,0x96,0x17,0x7a,0x9c,0xb4,0x10,0xff,0x61,0xf2,0x00,0x15,0xad};
	BYTE hash2[32] = {0x24,0x8d,0x6a,0x61,0xd2,0x06,0x38,0xb8,0xe5,0xc0,0x26,0x93,0x0c,0x3e,0x60,0x39,
	                                0xa3,0x3c,0xe4,0x59,0x64,0xff,0x21,0x67,0xf6,0xec,0xed,0xd4,0x19,0xdb,0x06,0xc1};
	BYTE hash3[32] = {0xf2,0x45,0x11,0xc0,0x55,0x60,0x76,0xde,0x9c,0x65,0x4f,0x6d,0xb8,0xc5,0xfd,0x74,
									0x89,0x8f,0x27,0xdd,0xb3,0x6d,0x3c,0x67,0x41,0x93,0x2a,0x78,0x0c,0x0b,0x66,0x24};
	BYTE buf[32];

	SHA256_CTX ctx;
	
	int idx;
	int pass = 1;

	sha256_init(&ctx);
	sha256_update(&ctx, text1, strlen(text1));
	sha256_final(&ctx, buf);
	sha256_show_result(buf);
	pass = pass && !memcmp(hash1, buf, 32);

	sha256_init(&ctx);
	sha256_update(&ctx, text2, strlen(text2));
	sha256_final(&ctx, buf);
	sha256_show_result(buf);
	pass = pass && !memcmp(hash2, buf, 32);

	sha256_init(&ctx);
	sha256_update(&ctx, text3, strlen(text3));
	sha256_final(&ctx, buf);
	sha256_show_result(buf);
	pass = pass && !memcmp(hash3, buf, 32);

	return(pass);
}

int main()
{
	printf("SHA-256 tests: %s\n", sha256_test() ? "SUCCEEDED" : "FAILED");

	return(0);
}
